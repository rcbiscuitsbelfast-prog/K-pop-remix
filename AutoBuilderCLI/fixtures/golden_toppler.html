<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AutoBuilderCLI Demo</title>
  <style>
    body { font-family: system-ui, sans-serif; background: #0f1115; color: #e6e6e6; }
    #stage { width: 800px; height: 450px; border: 1px solid #333; background: #000; }
    .controls { margin: 8px 0; display: flex; gap: 8px; align-items: center; }
    .physics-info { font-family: monospace; font-size: 12px; color: #888; }
  </style>
</head>
<body>
  <h1>AutoBuilderCLI Demo</h1>
  <div class="physics-info">Genre: Physics | Platform: Web | Assets: 6</div>
  <canvas id="stage"></canvas>
  <div class="controls">
    <button id="play">Play</button>
    <button id="pause">Pause</button>
    <button id="stop">Stop</button>
    <label><input type="checkbox" id="debug" checked/> Debug</label>
  </div>
  <script type="module">
    import { CanvasRenderPlayer } from '../ConvertToWebPure/CanvasPlayer.ts';
    
    // Physics scenario: TopplerDemoPure
    // Simulates falling block with gravity and collision
    const frames = [
      {
        "frameIndex": 0,
        "sprites": [
          {
            "id": "block",
            "x": 0,
            "y": -1.5,
            "layer": 0
          }
        ],
        "camera": {
          "x": 0,
          "y": 0,
          "zoom": 1
        },
        "backgroundColor": "#101820"
      },
      {
        "frameIndex": 1,
        "sprites": [
          {
            "id": "block",
            "x": 0,
            "y": -0.03,
            "layer": 0
          }
        ],
        "camera": {
          "x": 0,
          "y": 0,
          "zoom": 1
        },
        "backgroundColor": "#101820"
      },
      {
        "frameIndex": 2,
        "sprites": [
          {
            "id": "block",
            "x": 0,
            "y": 3.9,
            "layer": 0
          }
        ],
        "camera": {
          "x": 0,
          "y": 0,
          "zoom": 1
        },
        "backgroundColor": "#101820"
      }
    ];

    // Asset manifest integration
    const assetManifest = {
      "assets": [
        {
          "id": "block_sprite",
          "path": "assets/sprites/physics/block.png",
          "type": "sprite",
          "license": "cc0",
          "platform": "all"
        },
        {
          "id": "platform_sprite",
          "path": "assets/sprites/physics/platform.png",
          "type": "sprite",
          "license": "cc0",
          "platform": "all"
        },
        {
          "id": "impact_sound",
          "path": "assets/audio/physics/impact.wav",
          "type": "audio",
          "license": "cc0",
          "platform": "all"
        }
      ]
    };

    const canvas = document.getElementById('stage');
    const player = new CanvasRenderPlayer(canvas, frames, { 
      fps: 24, 
      debug: true,
      assets: assetManifest
    });

    // Physics simulation controls
    document.getElementById('play').addEventListener('click', () => player.play());
    document.getElementById('pause').addEventListener('click', () => player.pause());
    document.getElementById('stop').addEventListener('click', () => player.stop());
    document.getElementById('debug').addEventListener('change', (e) => player.setDebug(e.target.checked));

    // Physics-specific event handling
    player.onFrameChange = (frameIndex) => {
      const frame = frames[frameIndex];
      if (frame && frame.sprites.length > 0) {
        const block = frame.sprites[0];
        // Simulate physics-based interactions
        if (block.y >= 0 && frameIndex > 0) {
          // Block has landed on platform
          console.log('Physics: Block landed at y =', block.y);
        }
      }
    };
  </script>
</body>
</html>